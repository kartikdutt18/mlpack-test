# -*- coding: utf-8 -*-
"""Inference.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1Nqy3Q8BY-drjivWeCTkxpQnYGWkufJ77
"""

from google.colab import files
files.upload()

files.upload()

import pandas as pd
import math

dataset_without_blas = pd.read_csv('./results.csv', names = ['Activation-Function', 'Function-Type','Input-Size', 'Input-Type', 'Time-Taken (sec)'])

dataset_with_blas = pd.read_csv('./results_with_blas.csv', names = ['Activation-Function', 'Function-Type','Input-Size', 'Input-Type', 'Time-Taken (sec)'])

dataset_with_blas.tail(5)

import matplotlib.pyplot as plt

class ActivationFunction:
  def __init__(self, name):
    self.name = name
    self.armadilloVectorList = [0] * 4
    self.simpleVectorList = [0] * 4
    self.armadilloMatList = [0] * 4
    self.simpleMatList = [0] * 4
  
  def addStep(self,functionType,inSize,inputType,timeTaken):
    if functionType == "Simple" and inputType == "Vector":
      self.simpleVectorList[int(math.log10(inSize))] = timeTaken
    elif functionType == "Simple" and inputType == "Matrix":
      self.simpleMatList[int(math.log10(inSize))] = timeTaken
    elif functionType == "Armadillo" and inputType == "Vector":
      self.armadilloVectorList[int(math.log10(inSize))] = timeTaken
    elif functionType == "Armadillo" and inputType == "Matrix":
      self.armadilloMatList[int(math.log10(inSize))] = timeTaken

HardSigmoid = ActivationFunction('HardSigmoid')
Logistic = ActivationFunction('Logistic')
Mish = ActivationFunction('Mish')
SoftPlus = ActivationFunction('SoftPlus')
SoftSign=ActivationFunction ('SoftSign')
Swish=ActivationFunction ('Swish')

functionDictionary = {
    'HardSigmoid':HardSigmoid,
    'Logistic': Logistic,
    'Mish':Mish,
    'SoftPlus':SoftPlus,
    'SoftSign':SoftSign,
    'Swish':Swish
}

def buildDataset(dataset):
  for i in range(len(dataset)):
    functionDictionary[dataset.loc[i][0]].addStep(dataset.loc[i][1],dataset.loc[i][2], dataset.loc[i][3], dataset.loc[i][4])
  print("Build Successful!")

import os
inputSize = [1, 10, 100, 1000]
inputSize = [1, 20, 1100, 101000]
if not os.path.exists('./images'):
  os.mkdir('./images')

def plot(obj, blasOpt, i):
  plt.figure(i)
  plt.plot(inputSize, obj.simpleVectorList, label='simple')
  plt.plot(inputSize, obj.armadilloVectorList, label='armadillo')
  plt.ylabel('Time')
  plt.xlabel('InputSize')
  plt.title(obj.name + '_with_vector' + blasOpt)
  plt.legend()
  plt.savefig('./images/'+obj.name + '_with_vector' + blasOpt + '.png')
  plt.figure(i + 1)
  plt.plot(inputSize, obj.simpleMatList, label='simple')
  plt.plot(inputSize, obj.armadilloMatList, label='armadillo')
  plt.title(obj.name + '_with_matrix' + blasOpt)
  plt.ylabel('Time')
  plt.xlabel('InputSize')
  plt.legend()
  plt.savefig('./images/'+obj.name + '_with_matrix' + blasOpt + '.png')

def plotGraphs(blasOpt):
  plot(HardSigmoid, blasOpt, 1)
  plot(Logistic, blasOpt, 3)
  plot(Mish, blasOpt, 5)
  plot(SoftPlus, blasOpt, 7)
  plot(Swish, blasOpt, 9)

buildDataset(dataset_without_blas)
plotGraphs('_without_blas')

buildDataset(dataset_with_blas)
plotGraphs('_with_blas')

!zip -r ./images.zip ./images

files.download('images.zip')

